<%= render partial: 'test_executions/steps/progress_bubbles', locals: {step: @current_step_number, steps: @total_steps} %>
<%= progress_bar %>

<script>
  $(document).ready( function(){
    $('#checkAll').click(function () {
      $('.check').prop('checked', $(this).prop('checked'));
    });
  });
</script>

<div class='container'>
  <div class='col-md-12'>
    <div class='process-title'><h3>Choose Measures</h3></div>
  </div>
  <%= render partial: 'test_executions/steps/disabled' %>
  <div class='process-content'>
    <%= form_for @test_execution, url: wizard_path, html: {'data-parsley-validate': ''}, method: :put do |f| %>
        <div class='form-group'>
          <div class='col-md-8'>
            <% unless @test_execution[:disable_details] %>
              <div class='panel-selection-bar'>
                <div class='checkbox'>
                  <label><input type='checkbox' class='check' id='checkAll'>Select All</label>
                </div>
              </div>
            <% end %>
          <%= field_set_tag 'Measure List (Select at least one)', id: 'cqm_list' do %>
            <div class='list-group'>
              <%= f.collection_check_boxes :measure_ids, @measures, :id, :cms_id do |b| %>
                <div class='list-group-item'>
                  <div class='collection-check-box'>
                    <%= b.check_box(
                      disabled: @test_execution[:disable_details],
                      class:'check',
                      'data-parsley-required':'',
                      'data-parsley-mincheck':'1',
                      'data-parsley-required-message':'You need to select at least one measure',
                      'data-parsley-errors-container':'#cqm_list',
                      'data-parsley-group':'cqm_list'
                    ) %>
                    <%= b.label %> - <%= b.object.title %>
                  </div>
                </div>
              <% end %>
            </div>
          <% end %>
        </div>
      </div>
      <div class='col-md-4'>
        <h4>About Measures</h4>
        <p>When using Cedar, you can choose which eCQMs you wish to include in your QRDA test files.</p>
        <p>You must choose at least one measure, but you are free to choose as many as you would care to test.</p>
        <p>Cedar will randomly choose from the measures you select to create the QRDA files for the test.</p>
      </div>
      <div class='clearfix'></div>
      <div class='process-nav'>
        <%= link_to 'Delete Test', @test_execution, method: :delete, class: 'btn btn-default', data: confirm_delete %>
        <%= button_tag(class: 'btn btn-primary pull-right') do %>
          Next <i class='glyphicon glyphicon-chevron-right'></i>
        <% end %>
      </div>
    <% end %>
  </div>
</div>
