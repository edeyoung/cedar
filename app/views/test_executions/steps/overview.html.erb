<%= render partial: 'test_executions/steps/progress_bubbles', locals: {step: @current_step_number, steps: @total_steps} %>
<%= progress_bar %>
<div class='container'>
  <div class='col-lg-12'>
    <div class="panel panel-default">
      <div class='process-title panel-heading'><h3>Overview</h3></div>
        <div class="panel-body">
          <table class="table table-condensed" style="border-collapse:collapse;">
            <thead>
             <tr><th>&nbsp;</th>
                 <th>Tested Document</th>
                 <th>Expected</th>
                 <th>Actual</th>
                 <th>Status</th>
             </tr>
           </thead>
           <tbody>
             <% @test_execution.documents.all.each do |doc| %>
               <tr data-toggle="collapse" data-target='#collapse<%= doc.id.to_s %>' class="accordion-toggle">
                   <td><button class="btn btn-default btn-xs"><span class="glyphicon glyphicon-plus"></span></button></td>
                   <td><%= doc.name.to_s %></td>
                   <td><% if doc.state == :passed %>
                        <h4 class='text-success'><span class="text-nowrap"><i class='glyphicon glyphicon-check'></i> Passed</span></h4>
                     <% else %>
                        <h4 class='text-danger'><span class="text-nowrap"><i class='glyphicon glyphicon-exclamation-sign'></i> Failed</span></h4>
                        <% end %></td>
                   <td><% if doc.actual_result == :accept %>
                       <h3 style='margin: 5px 0'><span class='label label-success'>Accept</span></h4>
                         <% else %>
                       <h3 style='margin: 5px 0'><span class='label label-danger'>Reject</span></h4>
                     <% end %></td>
                   <td><% if doc.expected_result == :accept %>
                     <h4 class='text-success'>Accept</h4>
                   <% else %>
                     <h4 class='text-danger'>Reject</h4>
                   <% end %>
                 </td>
               </tr>
               <tr>
                   <td colspan="12" class="hiddenRow"><div class="accordian-body collapse" id='collapse<%= doc.id.to_s %>'>
                     <table class="table table-striped">
                             <thead>
                             </thead>
                             <tbody>
                               <tr id='collapse<%= doc.id.to_s %>'><td>  <% if doc.validation_id %>
                                  <h4><%= doc.validation.name %></h4>
                                  <p><%= doc.validation.overview_text %></p>
                                <% else %>
                                  <h4>No errors</h4>
                                  <p>This file contained no validation errors and was expected to be accepted by the eCQM collection system.</p>
                                <% end %>
                              </tr>
                             </tbody>
                       </table>
                     </div> </td>
               </tr>
               <% end %>
           </tbody>
         </table>
        </div
  <div class='clearfix'></div>
  <div class='process-nav'>
    <%= link_to 'Delete Test', @test_execution, method: :delete, class: 'btn btn-default', data: confirm_delete %>
    <!-- It's important to set this to root_url instead of next_wizard_path so
    clicking on the test from the dashboard will still land the user on this page -->
    <%= link_to root_url, class: 'btn btn-primary label-success pull-right' do %>
      <i class='glyphicon glyphicon-ok'></i> Finish
    <% end %>
    <%= link_to 'Back', previous_wizard_path, class: 'btn pull-right' %>
  </div>
</div>
